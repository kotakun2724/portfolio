---
import '../styles/global.css';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import Seo from '../components/Seo.astro';

type Props = {
  title: string;
  description?: string;
  pathname?: string;
};

const { title, description, pathname } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <Seo title={title} description={description} pathname={pathname} />
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>
    <div class="page">
      <Header />
      <main id="main" class="main">
        <slot />
      </main>
      <Footer />
    </div>

    <script is:inline>
      (() => {
        const reduceMotion =
          window.matchMedia &&
          window.matchMedia('(prefers-reduced-motion: reduce)').matches;
        const revealAll = () => {
          for (const el of document.querySelectorAll('[data-reveal]')) {
            el.classList.add('is-revealed');
          }
        };

        if (reduceMotion) {
          revealAll();
          return;
        }

        const els = Array.from(document.querySelectorAll('[data-reveal]'));
        if (els.length === 0) return;

        if (!('IntersectionObserver' in window)) {
          revealAll();
          return;
        }

        const io = new IntersectionObserver(
          (entries) => {
            for (const e of entries) {
              if (!e.isIntersecting) continue;
              const el = e.target;
              el.classList.add('is-revealed');
              io.unobserve(el);
            }
          },
          { root: null, threshold: 0.12, rootMargin: '0px 0px -8% 0px' },
        );

        for (const el of els) io.observe(el);
      })();
    </script>
  </body>
</html>


